<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"><title data-react-helmet="true">Expressible and high performing mathematical libraries  (2016 - ongoing) | VecPy</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Expressible and high performing mathematical libraries  (2016 - ongoing) | VecPy"><meta data-react-helmet="true" name="description" content="Background"><meta data-react-helmet="true" property="og:description" content="Background"><meta data-react-helmet="true" property="og:url" content="https://ooreilly.github.io//vecpy/docs/api/codegen"><link data-react-helmet="true" rel="shortcut icon" href="/vecpy/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ooreilly.github.io//vecpy/docs/api/codegen"><link rel="stylesheet" href="/vecpy/styles.b453356d.css">
<link rel="preload" href="/vecpy/styles.c8e8ba56.js" as="script">
<link rel="preload" href="/vecpy/runtime~main.47c93863.js" as="script">
<link rel="preload" href="/vecpy/main.b6936b52.js" as="script">
<link rel="preload" href="/vecpy/1.1e2e2731.js" as="script">
<link rel="preload" href="/vecpy/2.d80af85f.js" as="script">
<link rel="preload" href="/vecpy/3.eb7526d3.js" as="script">
<link rel="preload" href="/vecpy/1be78505.8e22857c.js" as="script">
<link rel="preload" href="/vecpy/60.18593aa0.js" as="script">
<link rel="preload" href="/vecpy/ce97f866.429b195f.js" as="script">
<link rel="preload" href="/vecpy/17896441.242191b2.js" as="script">
<link rel="preload" href="/vecpy/430c4fb3.d7a689ae.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/vecpy/"><img class="navbar__logo" src="/vecpy/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">VecPy</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/vecpy/docs/start/vecpy">Docs</a><a class="navbar__item navbar__link" href="/vecpy/docs/benchmarks/sum">Performance</a><a href="https://github.com/ooreilly/vecpy" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/vecpy/"><img class="navbar__logo" src="/vecpy/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">VecPy</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/vecpy/docs/start/vecpy">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/vecpy/docs/benchmarks/sum">Performance</a></li><li class="menu__list-item"><a href="https://github.com/ooreilly/vecpy" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Expressible and high performing mathematical libraries  (2016 - ongoing)</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="background"></a>Background<a aria-hidden="true" tabindex="-1" class="hash-link" href="#background" title="Direct link to heading">#</a></h2><p>When I was a teaching assistant for a modern Fortran programming class, the instructor, Damien
Rouson, planted a philosophy in mind that has stuck with me ever since that time. He said, we when write scientific
software, we should strive to write code that mimics the abstract nature of the mathematical
expressions that we write on the blackboard. The reality is that the source codes behind most scientific
software look nothing like the actual mathematical expressions that they implement. The reason why
we should strive for this level of abstraction is flexibility. With the right level of abstraction,
it should be possible to make changes without rewriting massive parts of the code. Such flexibility
encourages experimentation, and that may lead to new discoveries and breakthroughs. Damien
Rouson was convinced that to reach this level of abstraction in a scalable manner required a functional programming
approach, or graph-based approach. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tensorflow-and-blackboard-like-mathematical-expressivity"></a>TensorFlow and blackboard-like mathematical expressivity<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tensorflow-and-blackboard-like-mathematical-expressivity" title="Direct link to heading">#</a></h3><p>Today, we have libraries like TensorFlow that construct graphs to
provide powerful abstractions that make these blackboard like calculations possible.
While TensorFlow is primarily geared for machine
learning, it can also be used for computational physics simulations. This
<a href="https://github.com/tensorflow/examples/blob/master/community/en/pdes.ipynb" target="_blank" rel="noopener noreferrer">example</a> solves a
partial differential equation, like the
wave equation in 2D. The whole solution is just a few lines of code, and brings us one step closer
towards writing code that looks similar to the math you would write on a blackboard. In this regard,
libraries like TensorFlow greatly simplifies the task of not only doing machine learning, but also
solving partial differential equations. However, there
is a part of the story missing here. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-performance-gap"></a>The performance gap<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-performance-gap" title="Direct link to heading">#</a></h3><p>While TensorFlow makes it
possible to implement say the elastic wave equation in 3D, it is not an efficient solution.
As the bar charts below show, TensorFlow is about 4 - 7 times slower than the hand-coded solutions.</p><img alt="Elastic 3D benchmark" src="/vecpy/img/tensorflow_64.svg"><img alt="Elastic 3D benchmark" src="/vecpy/img/tensorflow_256.svg"><p><em>Time per time step (FPS) obtained when solving 3D elastic wave equation on a NVIDIA Titan X (Pascal).</em></p><p>Implementations tested:</p><ul><li><a href="https://github.com/gfabieno/SeisCL" target="_blank" rel="noopener noreferrer">SeisCL</a></li><li><a href="https://github.com/HPGeoC/awp-odc-os" target="_blank" rel="noopener noreferrer">AWP-ODC</a></li><li><a href="https://github.com/ooreilly/WaveFlow/blob/develop-ooreilly/problems/elastic3d.py" target="_blank" rel="noopener noreferrer">TensorFlow</a></li></ul><p>I wrote the 3D elastic wave equation solver using TensorFlow. This
implementation does not impose any boundary conditions. I have not put any effort into
testing that this implementation actually solves the elastic wave equation and not something else.
Furthermore, this implementation uses constant coefficients for the elastic material
properties, whereas the hand-coded implementations use variable coefficients. A variable coefficient
implementation would be even slower.  </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="a-closer-look-at-blackboard-like-mathematical-abstractions"></a>A closer look at blackboard-like mathematical abstractions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#a-closer-look-at-blackboard-like-mathematical-abstractions" title="Direct link to heading">#</a></h3><p>The beauty of the TensorFlow approach is that it is not far away from achieving the blackboard-like
mathematical abstractions. Let us take a closer look. Here are the governing equations for the linear elastic wave equation with an isotropic material in Cartesian coordinates,</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>=</mo><msub><mi mathvariant="normal">âˆ‚</mi><msub><mi>x</mi><mi>j</mi></msub></msub><msub><mi>Ïƒ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator="true">,</mo><mspace linebreak="newline"></mspace><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>Î»</mi><msub><mi mathvariant="normal">âˆ‚</mi><msub><mi>x</mi><mi>k</mi></msub></msub><msub><mi>v</mi><mi>k</mi></msub><msub><mi>Î´</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><mi>Î¼</mi><msub><mi mathvariant="normal">âˆ‚</mi><msub><mi>x</mi><mi>i</mi></msub></msub><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><mi>Î¼</mi><msub><mi mathvariant="normal">âˆ‚</mi><msub><mi>x</mi><mi>j</mi></msub></msub><msub><mi>v</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\partial_t v_i = \partial_{x_j} \sigma_{ij}, \\ \partial_t\sigma_{ij} = \lambda \partial_{x_k} v_k \delta_{ij} + \mu \partial_{x_i} v_j + \mu \partial_{x_j} v_i. </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.04176em;vertical-align:-0.34731999999999996em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34731999999999996em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord mathnormal">Î»</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139199999999997em"><span style="top:-2.55em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.25586em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em">Î´</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord mathnormal">Î¼</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139199999999997em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.04176em;vertical-align:-0.34731999999999996em"></span><span class="mord mathnormal">Î¼</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.34731999999999996em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></p><p>If we expand out the index notation expression, we obtain</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo>=</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>z</mi></mrow></msub><mo separator="true">,</mo><mspace linebreak="newline"></mspace><mi>Ï</mi><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>v</mi><mi>y</mi></msub><mo>=</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>z</mi></mrow></msub><mo separator="true">,</mo><mspace linebreak="newline"></mspace><mi>Ï</mi><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>v</mi><mi>z</mi></msub><mo>=</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>z</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>y</mi><mi>z</mi></mrow></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>z</mi><mi>z</mi></mrow></msub><mo separator="true">,</mo><mspace linebreak="newline"></mspace><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>=</mo><mi>Î»</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>v</mi><mi>y</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mi>Î¼</mi><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mspace linebreak="newline"></mspace><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo>=</mo><mi>Î»</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>v</mi><mi>y</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mi>Î¼</mi><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>v</mi><mi>y</mi></msub><mspace linebreak="newline"></mspace><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>z</mi><mi>z</mi></mrow></msub><mo>=</mo><mi>Î»</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>v</mi><mi>y</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mi>Î¼</mi><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>v</mi><mi>z</mi></msub><mspace linebreak="newline"></mspace><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>v</mi><mi>y</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>x</mi><mi>z</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>x</mi></msub><msub><mi>v</mi><mi>z</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>v</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi mathvariant="normal">âˆ‚</mi><mi>t</mi></msub><msub><mi>Ïƒ</mi><mrow><mi>y</mi><mi>z</mi></mrow></msub><mo>=</mo><mi>Î¼</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>y</mi></msub><msub><mi>v</mi><mi>z</mi></msub><mo>+</mo><msub><mi mathvariant="normal">âˆ‚</mi><mi>z</mi></msub><msub><mi>v</mi><mi>y</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\rho \partial_t v_x = \partial_x \sigma_{xx} + \partial_y \sigma_{xy} + \partial_z \sigma_{xz}, \\ \rho \partial_t v_y = \partial_x \sigma_{xy} + \partial_y \sigma_{yy} + \partial_z \sigma_{xz}, \\ \rho \partial_t v_z = \partial_x \sigma_{xz} + \partial_y \sigma_{yz} + \partial_z \sigma_{zz}, \\ \partial_t \sigma_{xx} = \lambda (\partial_x v_x + \partial_y v_y + \partial_z v_x) + 2\mu \partial_x v_x \\ \partial_t \sigma_{yy} = \lambda (\partial_x v_x + \partial_y v_y + \partial_z v_x) + 2\mu \partial_y v_y \\ \partial_t \sigma_{zz} = \lambda (\partial_x v_x + \partial_y v_y + \partial_z v_x) + 2\mu \partial_z v_z \\ \partial_t \sigma_{xy} = \mu (\partial_x v_y + \partial_y v_x) \\ \partial_t \sigma_{xz} = \mu (\partial_x v_z + \partial_z v_x) \\ \partial_t \sigma_{yz} = \mu (\partial_y v_z + \partial_z v_y)  \\</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathnormal">Ï</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord mathnormal">Ï</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathnormal">Ï</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Î»</span><span class="mopen">(</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord">2</span><span class="mord mathnormal">Î¼</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Î»</span><span class="mopen">(</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord">2</span><span class="mord mathnormal">Î¼</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Î»</span><span class="mopen">(</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord">2</span><span class="mord mathnormal">Î¼</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em"></span><span class="mord mathnormal">Î¼</span><span class="mopen">(</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">Î¼</span><span class="mopen">(</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">Ïƒ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em"></span><span class="mord mathnormal">Î¼</span><span class="mopen">(</span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">âˆ‚</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span></span></span></span></p><p>And this is the TensorFlow implementation taken from <a href="https://github.com/ooreilly/WaveFlow/blob/develop-ooreilly/problems/elastic3d.py" target="_blank" rel="noopener noreferrer">here</a> with minor modifications:  </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Velocities</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vy </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vy0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vz </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vz0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Stresses</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxx0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxy </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxy0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxz </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxz0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">syy </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">syy0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">syz </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">syz0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">szz </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">szz0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Derivatives of velocities</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vx_x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dx3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vx_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dy3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vx_z </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dz3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vy_x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dx3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vy_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dy3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vy_z </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dz3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vz_x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dx3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vz_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dy3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vz_z </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dz3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Derivatives of stresses (implemented using convolution stencils)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxx_x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dxh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxy_x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dxh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxz_x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dxh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxy_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dyh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">syy_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dyh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">syy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">syz_y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dyh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">syz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxz_z </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dzh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">syz_z </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dzh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">syz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">szz_z </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> k</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Dzh3d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">szz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Momentum balance</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vx_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> vx </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> rhoi </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxx_x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> sxy_y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> sxz_z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vy_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> vy </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> rhoi </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxy_x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> syy_y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> syz_z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vz_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> vz </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> rhoi </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sxz_x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> syz_y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> szz_z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Time derivative of Hooke&#x27;s law for a linear isotropoic elastic material</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxx_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sxx </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lam </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx_x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vy_y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vz_z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> mu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> vx_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">syy_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> syy </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lam </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx_x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vy_y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vz_z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> mu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> vy_y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">szz_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> szz </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lam </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx_x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vy_y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vz_z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> mu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> vz_z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxy_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sxy </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> mu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx_y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vy_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">sxz_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sxz </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> mu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vx_z </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vz_x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">syz_t </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> syz </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> nu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> mu </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vy_z </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> vz_y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div></div></div><p>As you can see, the last few lines of code show a striking resemblance to the actual mathematical
equations. The derivatives are implemented via finite difference stencils that map to convolution kernels in TensorFlow, see <a href="https://github.com/ooreilly/ooreilly.github.io/codes/codegen/kernels.py" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Unfortunately, as you saw earlier, this solution is inefficient. In the sections that
follow, you will see why this solution is inefficient. You will also see that similar inefficient
solutions exist in libraries like NumPy, and NumPy-like libraries that targeted the GPU. I also
share some of my work-arounds that can dramatically improve the performance, and what I believe is
important for future work. I my free time, I am in pursuit of developing solutions that are
highly expressible via black-board like abstractions and also delivers high performance. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="linear-algebra"></a>Linear algebra<a aria-hidden="true" tabindex="-1" class="hash-link" href="#linear-algebra" title="Direct link to heading">#</a></h2><p><a href="https://www.mathworks.com/products/matlab.html" target="_blank" rel="noopener noreferrer">Matlab</a>, <a href="https://www.gnu.org/software/octave/" target="_blank" rel="noopener noreferrer">Octave</a>, <a href="https://www.wolfram.com/mathematica/" target="_blank" rel="noopener noreferrer">Mathematica</a>, <a href="https://julialang.org/" target="_blank" rel="noopener noreferrer">Julia</a>, and libraries like <a href="https://numpy.org/" target="_blank" rel="noopener noreferrer">NumPy</a>, <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page" target="_blank" rel="noopener noreferrer">Eigen</a>
provide high-level and convenient interfaces for basic linear algebra computations.
Under the hood of these packages lies highly efficient implementations of the <a href="http://www.netlib.org/blas/" target="_blank" rel="noopener noreferrer">BLAS</a> specification.
As you can see, the BLAS specification is a collection of functions that perform linear algebra
operations like the dot product, matrix vector multiplication, and matrix matrix multiplication. If
you use a BLAS library directly instead of using a high-level library like NumPy, the syntax is
quite verbose and easily obfuscates the underlying mathematical expressions. On the other hand, the
high-level aspect of NumPy hides implementation details that can have a negative impact on
performance. Next, you will see why this is the case.</p><p>Suppose you are interested in computing
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi><mo>â†</mo><mi>Î±</mi><mi mathvariant="bold">x</mi><mo>+</mo><mi>Î²</mi><mi mathvariant="bold">y</mi><mo>+</mo><mi>Î³</mi><mi mathvariant="bold">z</mi></mrow><annotation encoding="application/x-tex">\mathbf{v} \leftarrow \alpha \mathbf{x} + \beta \mathbf{y} + \gamma \mathbf{z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em">v</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Î±</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05278em">Î²</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em">y</span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05556em">Î³</span><span class="mord"><span class="mord mathbf">z</span></span></span></span></span></span>, where
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Î±</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î²</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05278em">Î²</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î³</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05556em">Î³</span></span></span></span></span> are scalars, and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em">y</span></span></span></span></span></span>, and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">z</mi></mrow><annotation encoding="application/x-tex">\mathbf{z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em"></span><span class="mord"><span class="mord mathbf">z</span></span></span></span></span></span> are
vectors of length <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span>. </p><p>Using NumPy, this linear algebra expression could be implemented by </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">v </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> alpha </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> beta </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> gamma </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></div></div></div></div></div><p>See <a href="https://github.com/ooreilly/ooreilly.github.io/codes/codegen/example1.py" target="_blank" rel="noopener noreferrer">here</a> for the
complete code.
The complete code contains some additional details that we will cover soon. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="temporary-arrays"></a>Temporary arrays<a aria-hidden="true" tabindex="-1" class="hash-link" href="#temporary-arrays" title="Direct link to heading">#</a></h3><p>For NumPy to be able to compute the previous expression, it needs to introduce temporary arrays. The
term <code>alpha * x</code> will be stored in a temporary array, and <code>beta * y</code> will be stored in another
temporary array. Under certain circumstances, NumPy can reuse temporary arrays. So <code>gamma * z</code> may
be stored in one of the previous temporary arrays [<a href="#further-reading">1</a>]. Finally, NumPy needs
to allocate a new array to hold the output <code>v</code>. What you should take away from all of this is that NumPy may need to create several temporary arrays to
perform the computation. From one point view, this approach causes sudden memory allocation and deallocation
which can be problematic when working with large arrays. As a result,
this approach can have a negative impact on performance. On the other hand, this approach increases parallelism
because the computation of each term is independent of the other terms if there is one temporary
array per term.</p><p>It is possible to gain control over the number of temporary arrays that NumPy creates. NumPy provides the optional argument <code>out</code> to some of its functions. This argument allows NumPy to
write results directly to a pre-allocated array instead of returning by value (which will create a
copy of the input array). Using the <code>out</code> argument, we can implement the previous example using only
one temporary array <code>tmp</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">tmp </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">zeros_like</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">w </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">zeros_like</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># alpha * x</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">multiply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">alpha</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># beta * y</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">multiply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">beta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">tmp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># alpha *x + beta * y</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> tmp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># gamma * z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">multiply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gamma</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">tmp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># alpha * x + beta * y + gamma * z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> tmp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> out</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div></div></div><p>As you can see, this approach trades code readability for reducing the number of temporary arrays.
So unfortunately, we have now lost the capability to write clear and concise expressions.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="local-temporary-arrays"></a>Local temporary arrays<a aria-hidden="true" tabindex="-1" class="hash-link" href="#local-temporary-arrays" title="Direct link to heading">#</a></h3><p>The library <a href="https://github.com/pydata/numexpr" target="_blank" rel="noopener noreferrer">NumExpr</a> takes a different approach than NumPy to
achieve speedups for certain mathematical expressions. As explained in their documentation, they
take a man in the middle approach that only uses small, and local temporary arrays. This solution
avoids all the excess memory traffic caused by the temporary arrays approach that NumPy takes.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="numpy-like-gpu-libraries"></a>NumPy-like GPU libraries<a aria-hidden="true" tabindex="-1" class="hash-link" href="#numpy-like-gpu-libraries" title="Direct link to heading">#</a></h3><p>It is become more and more popular to accelerate compute-intense mathematical expressions using
GPUs. One library that closely mimics the syntax of NumPy is <a href="https://github.com/cupy/cupy" target="_blank" rel="noopener noreferrer">CuPY</a>.
This library works for CUDA-enabled GPUs and implements a subset of the NumPy library. The library
<a href="https://github.com/lebedov/scikit-cuda" target="_blank" rel="noopener noreferrer">scikit-cuda</a> is another
library that supports NumPY-like functionality for CUDA-enabled GPUs. Both CuPy and scikit-cuda introduce temporary arrays like NumPy. To the best of my knowledge, there are no NumExpr-like libraries for the GPU.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="vecpy"></a>VecPy<a aria-hidden="true" tabindex="-1" class="hash-link" href="#vecpy" title="Direct link to heading">#</a></h3><p>To overcome the potential performance penalties due to temporary arrays, I decided to write my own
light-weight library that runs on CUDA-enabled GPUs. Currently, this library supports an extremely limited set of the core NumPy
functionality. Only vector operations are supported (i.e., dot product, and element wise
multiplication). However, it can achieve dramatic speedups compared to the other libraries. Its
syntax is a slightly bit more complicated than NumPy. For example, suppose you want to compute
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><msubsup><mo>âˆ‘</mo><mi>i</mi><mi>n</mi></msubsup><mi>Î±</mi><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><mi>Î²</mi><msubsup><mi>y</mi><mi>i</mi><mn>2</mn></msubsup></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{\sum_{i}^n \alpha x_i^2 + \beta y_i^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.302709em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.937291em"><span class="svg-align" style="top:-3.2em"><span class="pstrut" style="height:3.2em"></span><span class="mord" style="padding-left:1em"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:0.0037em">Î±</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959080000000001em"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:0.05278em">Î²</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959080000000001em"><span style="top:-2.4231360000000004em;margin-left:-0.03588em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em"><span></span></span></span></span></span></span></span></span><span style="top:-2.897291em"><span class="pstrut" style="height:3.2em"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em"><svg width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.302709em"><span></span></span></span></span></span></span></span></span></span>. Here is a NumPy implementation using randomly initialized values:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> np</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">n</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1e7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alpha </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">beta </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">norm </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">sum</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">alpha </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> x</span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> beta </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> y</span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div></div></div><p>and here is a VecPy implementation:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> np</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> vecpy </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> vp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">n</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1e7</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">x </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">rand</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">alpha </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">beta </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Copy NumPy arrays to the GPU</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> vp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_vecpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">vy </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> vp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_vecpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">norm </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">vp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">sum</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">alpha </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> vx</span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> beta </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> vy</span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div></div></div><p>Note that, you should call <code>np.sqrt()</code> and not <code>vp.sqrt()</code> at the end. This is because <code>vp.sum()</code>
returns a scalar value that gets copied over the CPU. </p><p>Timing results for <code>n = 1e7</code>, are:</p><ul><li>NumPy: 5.409374817973003 s </li><li>VecPy: 0.10328862397000194 s.</li></ul><p>These results were obtained by performing 100 iterations on a Intel(R) Core(TM) i7-6700K CPU @
4.00GHz and NVIDIA GeForce RTX 2080 Ti Graphics card. </p><p>Unlike NumPy, VecPy uses lazy-evaluation. So if you write an expression like <code>vx ** 2 + vy ** 2</code>,
almost nothing happens until you call one of VecPy&#x27;s compute functions (e.g., <code>sum()</code>).</p><img alt="VecPy sum benchmark" src="/vecpy/img/vecpy.svg"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="further-reading"></a>Further reading<a aria-hidden="true" tabindex="-1" class="hash-link" href="#further-reading" title="Direct link to heading">#</a></h2><ol><li><a href="https://github.com/tensorflow/examples/blob/master/community/en/pdes.ipynb" target="_blank" rel="noopener noreferrer">TensorFlow Partial Differential Equation Example</a></li><li><a href="https://www.futurelearn.com/courses/python-in-hpc/0/steps/65112" target="_blank" rel="noopener noreferrer">Python in HPC: Temporary Arrays</a></li></ol></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ooreilly/vecpy/docs/api/test.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link">Background</a><ul><li><a href="#tensorflow-and-blackboard-like-mathematical-expressivity" class="table-of-contents__link">TensorFlow and blackboard-like mathematical expressivity</a></li><li><a href="#the-performance-gap" class="table-of-contents__link">The performance gap</a></li><li><a href="#a-closer-look-at-blackboard-like-mathematical-abstractions" class="table-of-contents__link">A closer look at blackboard-like mathematical abstractions</a></li></ul></li><li><a href="#linear-algebra" class="table-of-contents__link">Linear algebra</a><ul><li><a href="#temporary-arrays" class="table-of-contents__link">Temporary arrays</a></li><li><a href="#local-temporary-arrays" class="table-of-contents__link">Local temporary arrays</a></li><li><a href="#numpy-like-gpu-libraries" class="table-of-contents__link">NumPy-like GPU libraries</a></li><li><a href="#vecpy" class="table-of-contents__link">VecPy</a></li></ul></li><li><a href="#further-reading" class="table-of-contents__link">Further reading</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright Â© 2020 VecPy. Built with Docusaurus.</div></div></div></footer></div>
<script src="/vecpy/styles.c8e8ba56.js"></script>
<script src="/vecpy/runtime~main.47c93863.js"></script>
<script src="/vecpy/main.b6936b52.js"></script>
<script src="/vecpy/1.1e2e2731.js"></script>
<script src="/vecpy/2.d80af85f.js"></script>
<script src="/vecpy/3.eb7526d3.js"></script>
<script src="/vecpy/1be78505.8e22857c.js"></script>
<script src="/vecpy/60.18593aa0.js"></script>
<script src="/vecpy/ce97f866.429b195f.js"></script>
<script src="/vecpy/17896441.242191b2.js"></script>
<script src="/vecpy/430c4fb3.d7a689ae.js"></script>
</body>
</html>